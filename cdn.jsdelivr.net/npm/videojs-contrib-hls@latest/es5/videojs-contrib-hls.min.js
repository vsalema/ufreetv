/**
 * Minified by jsDelivr using UglifyJS v3.4.4.
 * Original file: /npm/videojs-contrib-hls@5.15.0/es5/videojs-contrib-hls.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";var _createClass=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}}(),_get=function(e,t,r){for(var i=!0;i;){var l=e,s=t,o=r;i=!1,null===l&&(l=Function.prototype);var a=Object.getOwnPropertyDescriptor(l,s);if(void 0!==a){if("value"in a)return a.value;var n=a.get;if(void 0===n)return;return n.call(o)}var u=Object.getPrototypeOf(l);if(null===u)return;e=u,t=s,r=o,i=!0,a=u=void 0}};function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _globalDocument=require("global/document"),_globalDocument2=_interopRequireDefault(_globalDocument),_playlistLoader=require("./playlist-loader"),_playlistLoader2=_interopRequireDefault(_playlistLoader),_playlist=require("./playlist"),_playlist2=_interopRequireDefault(_playlist),_xhr=require("./xhr"),_xhr2=_interopRequireDefault(_xhr),_aesDecrypter=require("aes-decrypter"),_binUtils=require("./bin-utils"),_binUtils2=_interopRequireDefault(_binUtils),_videojsContribMediaSources=require("videojs-contrib-media-sources"),_m3u8Parser=require("m3u8-parser"),_m3u8Parser2=_interopRequireDefault(_m3u8Parser),_videoJs=require("video.js"),_videoJs2=_interopRequireDefault(_videoJs),_masterPlaylistController=require("./master-playlist-controller"),_config=require("./config"),_config2=_interopRequireDefault(_config),_renditionMixin=require("./rendition-mixin"),_renditionMixin2=_interopRequireDefault(_renditionMixin),_globalWindow=require("global/window"),_globalWindow2=_interopRequireDefault(_globalWindow),_playbackWatcher=require("./playback-watcher"),_playbackWatcher2=_interopRequireDefault(_playbackWatcher),_reloadSourceOnError=require("./reload-source-on-error"),_reloadSourceOnError2=_interopRequireDefault(_reloadSourceOnError),_playlistSelectorsJs=require("./playlist-selectors.js"),Hls={PlaylistLoader:_playlistLoader2.default,Playlist:_playlist2.default,Decrypter:_aesDecrypter.Decrypter,AsyncStream:_aesDecrypter.AsyncStream,decrypt:_aesDecrypter.decrypt,utils:_binUtils2.default,STANDARD_PLAYLIST_SELECTOR:_playlistSelectorsJs.lastBandwidthSelector,INITIAL_PLAYLIST_SELECTOR:_playlistSelectorsJs.lowestBitrateCompatibleVariantSelector,comparePlaylistBandwidth:_playlistSelectorsJs.comparePlaylistBandwidth,comparePlaylistResolution:_playlistSelectorsJs.comparePlaylistResolution,xhr:(0,_xhr2.default)()},INITIAL_BANDWIDTH=4194304;["GOAL_BUFFER_LENGTH","MAX_GOAL_BUFFER_LENGTH","GOAL_BUFFER_LENGTH_RATE","BUFFER_LOW_WATER_LINE","MAX_BUFFER_LOW_WATER_LINE","BUFFER_LOW_WATER_LINE_RATE","BANDWIDTH_VARIANCE"].forEach(function(t){Object.defineProperty(Hls,t,{get:function(){return _videoJs2.default.log.warn("using Hls."+t+" is UNSAFE be sure you know what you are doing"),_config2.default[t]},set:function(e){_videoJs2.default.log.warn("using Hls."+t+" is UNSAFE be sure you know what you are doing"),"number"!=typeof e||e<0?_videoJs2.default.log.warn("value of Hls."+t+" must be greater than or equal to 0"):_config2.default[t]=e}})});var handleHlsMediaChange=function(e,t){for(var r=t.media(),i=-1,l=0;l<e.length;l++)if(e[l].id===r.uri){i=l;break}e.selectedIndex_=i,e.trigger({selectedIndex:i,type:"change"})},handleHlsLoadedMetadata=function(t,e){e.representations().forEach(function(e){t.addQualityLevel(e)}),handleHlsMediaChange(t,e.playlists)};Hls.canPlaySource=function(){return _videoJs2.default.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")},Hls.supportsNativeHls=function(){var t=_globalDocument2.default.createElement("video");if(!_videoJs2.default.getTech("Html5").isSupported())return!1;return["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(e){return/maybe|probably/i.test(t.canPlayType(e))})}(),Hls.isSupported=function(){return _videoJs2.default.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var Component=_videoJs2.default.getComponent("Component"),HlsHandler=function(e){function s(e,t,r){var i=this;if(_classCallCheck(this,s),_get(Object.getPrototypeOf(s.prototype),"constructor",this).call(this,t,r.hls),t.options_&&t.options_.playerId){var l=(0,_videoJs2.default)(t.options_.playerId);l.hasOwnProperty("hls")||Object.defineProperty(l,"hls",{get:function(){return _videoJs2.default.log.warn("player.hls is deprecated. Use player.tech_.hls instead."),t.trigger({type:"usage",name:"hls-player-access"}),i}})}if(this.tech_=t,this.source_=e,this.stats={},this.ignoreNextSeekingEvent_=!1,this.setOptions_(),this.options_.overrideNative&&(t.featuresNativeVideoTracks||t.featuresNativeAudioTracks))throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB");this.on(_globalDocument2.default,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],function(e){var t=_globalDocument2.default.fullscreenElement||_globalDocument2.default.webkitFullscreenElement||_globalDocument2.default.mozFullScreenElement||_globalDocument2.default.msFullscreenElement;t&&t.contains(i.tech_.el())&&i.masterPlaylistController_.fastQualityChange_()}),this.on(this.tech_,"seeking",function(){this.ignoreNextSeekingEvent_?this.ignoreNextSeekingEvent_=!1:this.setCurrentTime(this.tech_.currentTime())}),this.on(this.tech_,"error",function(){this.masterPlaylistController_&&this.masterPlaylistController_.pauseLoading()}),this.on(this.tech_,"play",this.play)}return _inherits(s,Component),_createClass(s,[{key:"setOptions_",value:function(){var t=this;this.options_.withCredentials=this.options_.withCredentials||!1,"number"!=typeof this.options_.blacklistDuration&&(this.options_.blacklistDuration=300),"number"!=typeof this.options_.bandwidth&&(this.options_.bandwidth=INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===INITIAL_BANDWIDTH,["withCredentials","bandwidth","handleManifestRedirects"].forEach(function(e){void 0!==t.source_[e]&&(t.options_[e]=t.source_[e])}),this.bandwidth=this.options_.bandwidth}},{key:"src",value:function(e){var t=this;e&&(this.setOptions_(),this.options_.url=this.source_.src,this.options_.tech=this.tech_,this.options_.externHls=Hls,this.masterPlaylistController_=new _masterPlaylistController.MasterPlaylistController(this.options_),this.playbackWatcher_=new _playbackWatcher2.default(_videoJs2.default.mergeOptions(this.options_,{seekable:function(){return t.seekable()}})),this.masterPlaylistController_.on("error",function(){_videoJs2.default.players[t.tech_.options_.playerId].error(t.masterPlaylistController_.error)}),this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):Hls.STANDARD_PLAYLIST_SELECTOR.bind(this),this.masterPlaylistController_.selectInitialPlaylist=Hls.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.masterPlaylistController_.masterPlaylistLoader_,this.mediaSource=this.masterPlaylistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(e){this.masterPlaylistController_.selectPlaylist=e.bind(this)}},throughput:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=e,this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.bandwidth},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=e,this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function(){var e=1/(this.bandwidth||1),t=void 0;return t=0<this.throughput?1/this.throughput:0,Math.floor(1/(e+t))},set:function(){_videoJs2.default.log.error('The "systemBandwidth" property is read-only')}}}),Object.defineProperties(this.stats,{bandwidth:{get:function(){return t.bandwidth||0},enumerable:!0},mediaRequests:{get:function(){return t.masterPlaylistController_.mediaRequests_()||0},enumerable:!0},mediaRequestsAborted:{get:function(){return t.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:!0},mediaRequestsTimedout:{get:function(){return t.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:!0},mediaRequestsErrored:{get:function(){return t.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:!0},mediaTransferDuration:{get:function(){return t.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:!0},mediaBytesTransferred:{get:function(){return t.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:!0},mediaSecondsLoaded:{get:function(){return t.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:!0}}),this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)),this.masterPlaylistController_.on("selectedinitialmedia",function(){(0,_renditionMixin2.default)(t)}),this.on(this.masterPlaylistController_,"progress",function(){this.tech_.trigger("progress")}),this.on(this.masterPlaylistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.tech_.ready(function(){return t.setupQualityLevels_()}),this.tech_.el()&&this.tech_.src(_videoJs2.default.URL.createObjectURL(this.masterPlaylistController_.mediaSource)))}},{key:"setupQualityLevels_",value:function(){var e=this,t=_videoJs2.default.players[this.tech_.options_.playerId];t&&t.qualityLevels&&(this.qualityLevels_=t.qualityLevels(),this.masterPlaylistController_.on("selectedinitialmedia",function(){handleHlsLoadedMetadata(e.qualityLevels_,e)}),this.playlists.on("mediachange",function(){handleHlsMediaChange(e.qualityLevels_,e.playlists)}))}},{key:"play",value:function(){this.masterPlaylistController_.play()}},{key:"setCurrentTime",value:function(e){this.masterPlaylistController_.setCurrentTime(e)}},{key:"duration",value:function(){return this.masterPlaylistController_.duration()}},{key:"seekable",value:function(){return this.masterPlaylistController_.seekable()}},{key:"dispose",value:function(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.masterPlaylistController_&&this.masterPlaylistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),_get(Object.getPrototypeOf(s.prototype),"dispose",this).call(this)}}]),s}(),HlsSourceHandler=function i(l){return{canHandleSource:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=_videoJs2.default.mergeOptions(_videoJs2.default.options,t);return(!r.hls||!r.hls.mode||r.hls.mode===l)&&i.canPlayType(e.type,r)},handleSource:function(e,t){var r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],i=_videoJs2.default.mergeOptions(_videoJs2.default.options,r,{hls:{mode:l}});return"flash"===l&&t.setTimeout(function(){t.trigger("loadstart")},1),t.hls=new HlsHandler(e,t,i),t.hls.xhr=(0,_xhr2.default)(),t.hls.src(e.src),t.hls},canPlayType:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=_videoJs2.default.mergeOptions(_videoJs2.default.options,t);return i.canPlayType(e,r)?"maybe":""}}};HlsSourceHandler.canPlayType=function(e,t){if(_videoJs2.default.browser.IE_VERSION&&_videoJs2.default.browser.IE_VERSION<=10)return!1;return!(!t.hls.overrideNative&&Hls.supportsNativeHls)&&/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i.test(e)},void 0!==_videoJs2.default.MediaSource&&void 0!==_videoJs2.default.URL||(_videoJs2.default.MediaSource=_videojsContribMediaSources.MediaSource,_videoJs2.default.URL=_videojsContribMediaSources.URL);var flashTech=_videoJs2.default.getTech("Flash");_videojsContribMediaSources.MediaSource.supportsNativeMediaSources()&&_videoJs2.default.getTech("Html5").registerSourceHandler(HlsSourceHandler("html5"),0),_globalWindow2.default.Uint8Array&&flashTech&&flashTech.registerSourceHandler(HlsSourceHandler("flash")),_videoJs2.default.HlsHandler=HlsHandler,_videoJs2.default.HlsSourceHandler=HlsSourceHandler,_videoJs2.default.Hls=Hls,_videoJs2.default.use||_videoJs2.default.registerComponent("Hls",Hls),_videoJs2.default.m3u8=_m3u8Parser2.default,_videoJs2.default.options.hls=_videoJs2.default.options.hls||{},_videoJs2.default.registerPlugin?_videoJs2.default.registerPlugin("reloadSourceOnError",_reloadSourceOnError2.default):_videoJs2.default.plugin("reloadSourceOnError",_reloadSourceOnError2.default),module.exports={Hls:Hls,HlsHandler:HlsHandler,HlsSourceHandler:HlsSourceHandler};
//# sourceMappingURL=/sm/4582687a32903946b63f7b2ef0c8e1df5a1fddd3ed8bbaac56b80f187f43575c.map